#!/usr/bin/bash -e

# Remember the current working directory
CURRENT_DIR="$PWD"

# Change to Workcraft home directory and put it into the WORKCRAFT_HOME variable
cd "$(dirname "$0")"
WORKCRAFT_HOME="$PWD"

# Set the JVM executable in JAVA_BIN variable (if not defined yet)
if [[ -z $JAVA_BIN ]]; then
    if [[ -z $JAVA_HOME ]]; then
        JAVA_BIN=java
    else
        if [ -e $JAVA_HOME/bin/java ]; then
            JAVA_BIN="$JAVA_HOME/bin/java"
        else
            JAVA_BIN="$JAVA_HOME/java"
        fi
    fi
fi

# Run Workcraft with the specific JAVA_BIN and CLASSPATH
"$JAVA_BIN" -cp "$WORKCRAFT_HOME/workcraft.jar:$WORKCRAFT_HOME/plugins/*" org.workcraft.Console -dir:"$CURRENT_DIR" "$@"
